<!DOCTYPE html>
<html dir="ltr" lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=5.0" />
    <title>Stencil Component Starter</title>

    <script type="module" src="/build/rapyd-pay-portal.esm.js"></script>
    <script nomodule src="/build/rapyd-pay-portal.js"></script>
    <script src="https://sandboxcheckouttoolkit.rapyd.net" async></script>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
  </head>
  <body>
    <script>
      window.addEventListener('onCheckoutPaymentSuccess', function (event) {
        console.log(event.detail);
        feedback(event);
      });
      window.addEventListener('onCheckoutFailure', function (event) {
        console.log(event.detail.error);
        feedback(event);
      });
      window.addEventListener('onCheckoutPaymentFailure', event => {
        console.log(event.detail.error);
        feedback(event);
      });

      // display information to the user
      function feedback(event) {
        if (event.detail.error) {
          document.getElementById('rapyd-checkout').setAttribute('title', 'Whoops!');
          document.getElementById('rapyd-checkout').setAttribute('action', 'Try Again');
          document.getElementById('rapyd-checkout').setAttribute('message', 'We cannot process your payment: ' + event.detail.error);
          // document.getElementById('image').src = 'img/no-bike.svg';
        } else {
          document.getElementById('rapyd-checkout').setAttribute('title', 'Success!');
          document.getElementById('rapyd-checkout').setAttribute('action', 'Home');
          document.getElementById('rapyd-checkout').setAttribute('message', 'Thank you! Your product is on its way! Order: ' + event.detail.metadata.sales_order);
          // document.getElementById('image').src = 'img/logo.svg';
        }

        document.getElementById('feedback').style.display = 'block';
      }
    </script>
    <rapyd-pay-portal checkout-id="checkout_b00dd800f321d89cd9825be5703e5997"></rapyd-pay-portal>
  </body>
</html>
